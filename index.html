<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tesstrw</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-auth.js"></script>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">
    <div class="w-full max-w-md bg-white shadow-lg rounded-lg p-6" id="authFormContainer">
        <h2 class="text-2xl font-bold text-center text-gray-700 mb-4">회원가입</h2>
        <form id="signupForm" class="space-y-4">
            <input type="email" id="signupEmail" placeholder="이메일" required class="w-full px-4 py-2 border rounded-md">
            <input type="password" id="signupPassword" placeholder="비밀번호 (8자 이상)" required class="w-full px-4 py-2 border rounded-md">
            <button type="submit" class="w-full bg-blue-500 text-white py-2 rounded-md hover:bg-blue-600 transition">회원가입</button>
        </form>

        <h2 class="text-2xl font-bold text-center text-gray-700 mt-6">로그인</h2>
        <form id="loginForm" class="space-y-4">
            <input type="email" id="loginEmail" placeholder="이메일" required class="w-full px-4 py-2 border rounded-md">
            <input type="password" id="loginPassword" placeholder="비밀번호" required class="w-full px-4 py-2 border rounded-md">
            <button type="submit" class="w-full bg-green-500 text-white py-2 rounded-md hover:bg-green-600 transition">로그인</button>
        </form>

        <button id="resetPasswordBtn" class="w-full bg-gray-500 text-white py-2 rounded-md hover:bg-gray-600 transition mt-4">비밀번호 재설정</button>
        
        <!-- 성공/실패 메시지 표시 -->
        <p id="message" class="text-center text-red-500 mt-4"></p>
    </div>

    <div id="welcomeMessage" class="hidden text-center text-4xl font-bold text-green-500">
        안녕
    </div>

    <script>
        // ✅ Firebase 초기화
        const firebaseConfig = {
            apiKey: "AIzaSyBdzMBmsEGCETm3Tf7N-op5ANgsydjkMWc",
            authDomain: "login-ddb0a.firebaseapp.com",
            projectId: "login-ddb0a",
            storageBucket: "login-ddb0a.firebasestorage.app",
            messagingSenderId: "722735085241",
            appId: "1:722735085241:web:9dde97154af644a4c1cd68",
            measurementId: "G-4B9B610VMH"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();

        // ✅ 회원가입 기능
        document.getElementById("signupForm").addEventListener("submit", function(event) {
            event.preventDefault();
            const email = document.getElementById("signupEmail").value;
            const password = document.getElementById("signupPassword").value;

            auth.createUserWithEmailAndPassword(email, password)
                .then(() => {
                    document.getElementById("message").textContent = "회원가입 성공!";
                    document.getElementById("message").classList.remove("text-red-500");
                    document.getElementById("message").classList.add("text-green-500");
                })
                .catch(error => {
                    document.getElementById("message").textContent = "회원가입 실패: " + error.message;
                    document.getElementById("message").classList.remove("text-green-500");
                    document.getElementById("message").classList.add("text-red-500");
                });
        });

        // ✅ 로그인 기능
        document.getElementById("loginForm").addEventListener("submit", function(event) {
            event.preventDefault();
            const email = document.getElementById("loginEmail").value;
            const password = document.getElementById("loginPassword").value;

            auth.signInWithEmailAndPassword(email, password)
                .then(() => {
                    // 로그인 성공 후 화면 변경
                    document.getElementById("authFormContainer").classList.add("hidden");
                    document.getElementById("welcomeMessage").classList.remove("hidden");

                    // 성공 문구
                    document.getElementById("message").textContent = "로그인 성공!";
                    document.getElementById("message").classList.remove("text-red-500");
                    document.getElementById("message").classList.add("text-green-500");
                })
                .catch(error => {
                    document.getElementById("message").textContent = "로그인 실패: " + error.message;
                    document.getElementById("message").classList.remove("text-green-500");
                    document.getElementById("message").classList.add("text-red-500");
                });
        });

        // ✅ 비밀번호 재설정 기능
        document.getElementById("resetPasswordBtn").addEventListener("click", function() {
            const email = prompt("비밀번호 재설정 링크를 받을 이메일을 입력하세요:");
            if (email) {
                auth.sendPasswordResetEmail(email)
                    .then(() => alert("비밀번호 재설정 메일을 보냈습니다."))
                    .catch(error => alert("오류 발생: " + error.message));
            }
        });

    </script>

    <!-- ✅ Firebase 최신 SDK 추가 -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-analytics.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBdzMBmsEGCETm3Tf7N-op5ANgsydjkMWc",
            authDomain: "login-ddb0a.firebaseapp.com",
            projectId: "login-ddb0a",
            storageBucket: "login-ddb0a.firebasestorage.app",
            messagingSenderId: "722735085241",
            appId: "1:722735085241:web:9dde97154af644a4c1cd68",
            measurementId: "G-4B9B610VMH"
        };

        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
    </script>

</body>
</html>
